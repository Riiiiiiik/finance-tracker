name: Rodar Analise de Risco Semanal

on:
  schedule:
    - cron: '0 3 * * 1' # Toda segunda-feira às 03:00 UTC
  workflow_dispatch: # Permite rodar manualmente clicando num botão para testar

jobs:
  executar_analise:
    runs-on: ubuntu-latest
    
    steps:
    - name: Baixar código do repositório
      uses: actions/checkout@v3

    - name: Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: Instalar Dependências
      run: |
        pip install -r scripts/requirements.txt

    - name: Executar Script de Risco
      env:
        # A chave que você pegou no Google AI Studio
        GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }} 
        # Se usar banco real, adicione as credenciais aqui também
        # DB_HOST: ${{ secrets.DB_HOST }}
        # DB_PASSWORD: ${{ secrets.DB_PASSWORD }}
      run: python scripts/analise_risco.py
